---
title: QPS、TPS、OPS、RPS.md
date: 2022-04-13 13:37:51
tags: [性能测试]
categories: [性能测试]
---

## QPS
QPS Queries Per Second 是每秒查询率 ,是一台服务器每秒能够相应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准。即每秒的响应请求数，也即是最大吞吐能力。

简单的说，QPS = req/sec = 请求数/秒。它代表的是服务器的机器的性能最大吞吐能力。

可以理解为：<font color=red>每秒处理的request 数量</font>

通常QPS作用：<font color=red>表达和衡量当前系统的负载。</font>

形容当前系统的运行状态时，例如可以说：当前QPS已经达到多少了

### 并发量与QPS之间的关系

`QPS = 并发量 / 平均响应时间`

`并发量 = QPS * 平均响应时间`

### 典型案例：

一个OA签到系统，某公司假设有600个人进行上班打卡，8:00为签到时间。

从7:50至8:00这10分钟之内，600个人访问此系统，假设每人访问签到一次为1分钟。 

请问：此OA系统的QPS是多少？并发数为多少？

* 首先确定平均响应时间，**平均响应时间** = 1 * 60 = 60秒
  由于600人处理了10分钟，顾10分钟的并发量是600 
* QPS = 并发量 / 平均响应时间 = 600 / （10*60） = 1人/秒
* 并发量 = QPS * 平均响应时间 = 1 * 60 = 60人




## TPS
TPS Transactions Per Second 也就是事务数/秒。一个事务是指一个客户机向服务器发送请求然后服务器做出反应的过程。客户机在发送请求时开始计时，收到服务器响应后结束计时，以此来计算使用的时间和完成的事务个数，最终利用这些信息作出的评估分。

TPS 的过程包括：客户端请求服务端、服务端内部处理、服务端返回客户端。


## QPS和TPS的联系和区别

### 联系
联系：都是性能指标，都是以秒为单位进行计算。

### 区别
* 吞吐量是数据层的指标，指单位时间内系统传输的数据量，以MB/GB等为单位

* TPS是网络协议层的指标，指一秒内成功完成的事务数。通常只在Loadrunner工具中使用。

* 吞吐量 = 一次性能测试过程中网络上传输的数据量的总和。


1、Tps即每秒处理事务数，包括了

用户请求服务器

服务器自己的内部处理

服务器返回给用户

这三个过程，每秒能够完成N个这三个过程，Tps也就是N；

2、Qps基本类似于Tps，但是不同的是，对于一个页面的一次访问，形成一个Tps；但一次页面请求，可能产生多次对服务器的请求，服务器对这些请求，就可计入“Qps”之中。

例子：

例如：访问一个页面会请求服务器3次，一次放，产生一个“T”，产生3个“Q”

例如：一个大胃王一秒能吃10个包子，一个女孩子0.1秒能吃1个包子，那么他们是不是一样的呢？答案是否定的，因为这个女孩子不可能在一秒钟吃下10个包子，她可能要吃很久。这个时候这个大胃王就相当于TPS，而这个女孩子则是QPS。虽然很相似，但其实是不同的。

## 并发数
并发数（并发度）：指系统同时能处理的请求数量，同样反应了系统的负载能力。这个数值可以分析机器1s内的访问日志数量来得到

## RPS 吞吐量

代表吞吐率，即 Requests Per Second 的缩写。吞吐率是服务器并发处理能力的量化描述，单位是 reqs/s，指的是某个并发用户数下单位时间内处理的请求数。

某个并发用户数下单位时间内能处理的最大的请求数，称之为最大吞吐率。

有人把 RPS 说等效于 QPS。其实可以看作同一个统计方式，只是叫法不同而已。RPS/QPS，可以使用 apche ab 工具进行测量。
吞吐量是指系统在单位时间内处理请求的数量，TPS、QPS都是吞吐量的常用量化指标。

系统吞吐量要素

一个系统的吞吐量（承压能力）与request（请求）对cpu的消耗，外部接口，IO等等紧密关联。

单个request 对cpu消耗越高，外部系统接口，IO影响速度越慢，系统吞吐能力越低，反之越高。

### 重要参数

* QPS(TPS),并发数，响应时间

* QPS(TPS)：每秒钟request/事务 数量

* 并发数：系统同时处理的request/事务数

* 响应时间：一般取平均响应时间

### 关系

QPS(TPS)=并发数/平均响应时间

一个系统吞吐量通常有QPS(TPS),并发数两个因素决定，每套系统这个两个值都有一个相对极限值，在应用场景访问压力下，只要某一项达到系统最高值，系统吞吐量就上不去了，如果压力继续增大，系统的吞吐量反而会下降，原因是系统超负荷工作，上下文切换，内存等等其他消耗导致系统性能下降。

## PV
PV（Page View）：页面访问量，即页面浏览量或点击量，用户每次刷新即被计算一次。可以统计服务一天的访问日志得到。


## UV
UV（Unique Visitor）：独立访客，统计1天内访问某站点的用户数。可以统计服务一天的访问日志并根据用户的唯一标识去重得到。响应时间（RT）：响应时间是指系统对请求作出响应的时间，一般取平均响应时间。可以通过Nginx、Apache之类的Web Server得到。


## DAU
DAU(Daily Active User)，日活跃用户数量。常用于反映网站、互联网应用或网络游戏的运营情况。DAU通常统计一日（统计日）之内，登录或使用了某个产品的用户数（去除重复登录的用户），与UV概念相似


## MAU
MAU(Month Active User)：月活跃用户数量，指网站、app等去重后的月活跃用户数量


## 系统吞吐量评估
我们在做系统设计的时候就需要考虑CPU运算，IO，外部系统响应因素造成的影响以及对系统性能的初步预估。

而通常情况下，我们面对需求，我们评估出来的出来QPS，并发数之外，还有另外一个维度：日pv。

通过观察系统的访问日志发现，在用户量很大的情况下，各个时间周期内的同一时间段的访问流量几乎一样。比如工作日的每天早上。只要能拿到日流量图和QPS我们就可以推算日流量。

通常的技术方法：

1、找出系统的最高TPS和日PV，这两个要素有相对比较稳定的关系（除了放假、季节性因素影响之外）

2、通过压力测试或者经验预估，得出最高TPS，然后跟进1的关系，计算出系统最高的日吞吐量。B2B中文和淘宝面对的客户群不一样，这两个客户群的网络行为不应用，他们之间的TPS和PV关系比例也不一样。

## 软件性能测试的基本概念和计算公式

软件做性能测试时需要关注哪些性能呢？

首先，开发软件的目的是为了让用户使用，我们先站在用户的角度分析一下，用户需要关注哪些性能。

对于用户来说，当点击一个按钮、链接或发出一条指令开始，到系统把结果已用户感知的形式展现出来为止，这个过程所消耗的时间是用户对这个软件性能的直观印 象。也就是我们所说的响应时间，当相应时间较小时，用户体验是很好的，当然用户体验的响应时间包括个人主观因素和客观响应时间，在设计软件时，我们就需要 考虑到如何更好地结合这两部分达到用户最佳的体验。如：用户在大数据量查询时，我们可以将先提取出来的数据展示给用户，在用户看的过程中继续进行数据检 索，这时用户并不知道我们后台在做什么。

用户关注的是用户操作的相应时间。

其次，我们站在管理员的角度考虑需要关注的性能点。

* 1、 响应时间

* 2、 服务器资源使用情况是否合理

* 3、 应用服务器和数据库资源使用是否合理

* 4、 系统能否实现扩展

* 5、 系统最多支持多少用户访问、系统最大业务处理量是多少

* 6、 系统性能可能存在的瓶颈在哪里

* 7、 更换那些设备可以提高性能

* 8、 系统能否支持7×24小时的业务访问

再次，站在开发（设计）人员角度去考虑。

* 1、 架构设计是否合理

* 2、 数据库设计是否合理

* 3、 代码是否存在性能方面的问题

* 4、 系统中是否有不合理的内存使用方式

* 5、 系统中是否存在不合理的线程同步方式

* 6、 系统中是否存在不合理的资源竞争

## EPS


## 参考文档
* [OPS TPS RPS 吞吐量 查询率 事物数目 每秒查询率 每秒处理事物数目](https://blog.csdn.net/yu1xue1fei/article/details/112727927)
* [QPS、TPS、并发用户数、吞吐量关系](https://opslabs.cn/archives/338)
* [并发量、QPS 和TPS区别_qq690452074的专栏-程序员资料_并发量](http://www.4k8k.xyz/article/liuming690452074/88385483)
* [QPS如何计算](https://www.google.com.hk/search?q=QPS%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97)
* [这个很实用——网站qps计算方法](https://www.cnblogs.com/fengjian2016/p/12321895.html)
* [PV、TPS、QPS是怎么计算出来的？](https://www.zhihu.com/question/21556347)
